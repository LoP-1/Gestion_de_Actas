<!-- Si NO estás en /login, muestra el layout completo; si estás en /login, solo muestra el login -->
<mat-sidenav-container class="main-container">
  <!-- Sidebar izquierdo (menú) -->
  <mat-sidenav mode="side" opened class="sidebar">
    <h2 class="sidebar-title">{{ panelTitle }}</h2>
    <mat-nav-list>
      <!-- Seleccionar Periodo (con submenú) -->
      <a mat-list-item (click)="togglePeriodoMenu()" [class.active]="isSeleccionarPeriodoActive()">
        <mat-icon>search</mat-icon>
        <span>Buscador por Periodo</span>
        <span class="spacer"></span>
        <mat-icon class="chevron" [class.open]="periodoMenuOpen">expand_more</mat-icon>
      </a>
      <div class="submenu" *ngIf="periodoMenuOpen">
        <a mat-list-item routerLink="/periodos" routerLinkActive="active" [routerLinkActiveOptions]="{ exact: true }">
          <mat-icon>event_available</mat-icon>
          <span>Seleccionar Periodo</span>
        </a>
        <a mat-list-item routerLink="/usuarios-periodo" routerLinkActive="active">
          <mat-icon>group</mat-icon>
          <span>Empleados del periodo</span>
        </a>
      </div>

      <!-- Buscador Usuarios -->
      <a mat-list-item [routerLink]="['/buscador-usuarios']" routerLinkActive="active">
        <mat-icon>search</mat-icon>
        <span>Buscador Usuarios</span>
      </a>

      <!-- Detalles Completos -->
      <a mat-list-item [routerLink]="['/detalles-completos', ultimoBoletaId ]" routerLinkActive="active">
        <mat-icon>print</mat-icon>
        <span>Detalles Completos</span>
      </a>

      <!-- Importar CSV (solo ADMIN) -->
      <a mat-list-item [routerLink]="['/importar']" routerLinkActive="active" *ngIf="isAdmin">
        <mat-icon>description</mat-icon>
        <span>Importar CSV</span>
      </a>

      <!-- Registrar Usuarios (solo ADMIN) -->
      <a mat-list-item [routerLink]="['/registrar']" routerLinkActive="active" *ngIf="isAdmin">
        <mat-icon>group_add</mat-icon>
        <span>Registrar Usuario</span>
      </a>
    </mat-nav-list>
  </mat-sidenav>

  <!-- Sidebar derecho (carrito) -->
  <mat-sidenav position="end" mode="side" opened class="carrito-sidebar">
    <h2 class="carrito-title">Lista de Boletas</h2>
    <div class="carrito-empty" *ngIf="carritoBoletas.length === 0">
      <mat-icon>info</mat-icon>
      <span>No hay boletas agregadas.</span>
    </div>
    <div class="carrito-list">
      <div class="carrito-item" *ngFor="let boleta of carritoBoletas">
        <div class="carrito-item-info">
          <strong class="carrito-item-name">{{ boleta.nombre }}</strong>
          <span class="carrito-item-periodo">Periodo: {{ boleta.periodo }}</span>
        </div>
        <div class="carrito-item-actions">
          <button mat-stroked-button color="warn" (click)="removerBoleta(boleta.id)">
            <mat-icon>delete</mat-icon>
            Quitar
          </button>
          <button mat-flat-button color="primary" [routerLink]="['/detalles-completos', boleta.id]">
            <mat-icon>open_in_new</mat-icon>
            Ver Detalle
          </button>
        </div>
      </div>
    </div>

    <!-- Botón flotante de Cerrar sesión -->
    <div class="logout-fab">
      <button mat-fab color="warn" (click)="logout()" aria-label="Cerrar sesión">
        <mat-icon>logout</mat-icon>
      </button>
    </div>
  </mat-sidenav>

  <!-- Contenido principal -->
  <mat-sidenav-content class="main-content">
    <router-outlet></router-outlet>
  </mat-sidenav-content>
</mat-sidenav-container>

<!-- Solo Login: Ocupa todo el espacio cuando estás en /login -->
<ng-template #soloLogin>
  <div class="login-fullscreen">
    <router-outlet></router-outlet>
  </div>
</ng-template>